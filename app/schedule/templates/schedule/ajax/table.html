{% load schedule_fileters %}
{% load schedule_tags %}

<div class="schedule__title-block flex">
  <h1 class="schedule__title">Расписание группы {{ user.group }}</h1>
  {% if page_obj %}
    {% include 'schedule/pagination.html' %}
  {% endif %}
</div>
<div class="schedule__list">
  {% if page_obj %}
    {% for date, day_table in page_obj %}
      <div class="schedule__table-block">
        <div class="schedule__table-title-block flex">
          <span class="schedule__table-descr">{{ date|get_weekday }}</span>
          <span class="schedule__table-descr">{{ date|date:'d.m.Y' }}</span>
        </div>
        <table class="schedule__table">
          <thead></thead>
          <tbody>
          {% for row in day_table %}
            {% get_user_note table date forloop.counter as note %}
            <tr {% if note %} class="schedule__existing-note-tr" {% endif %}>
              {% for cell in row %}
                <td>{{ cell }}</td>
              {% endfor %}
              <td class="note-pop-up hidden">
                <div class="note-block flex" data-schedule-name="{{ table }}" data-day="{{ date|date:'Y-m-d' }}" data-lesson-number="{{ forloop.counter }}">
                  {% if note %}
                    {% include 'note_block/display.html' %}
                  {% else %}
                    {% include 'note_block/create.html' %}
                  {% endif %}
                </div>
              </td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
      </div>
    {% endfor %}
  {% else %}
    <p>Расписание не найдено. Проверьте свои данные в профиле.</p>
  {% endif %}
</div>
{% if page_obj %}
  {% include 'schedule/pagination.html' %}
{% endif %}
